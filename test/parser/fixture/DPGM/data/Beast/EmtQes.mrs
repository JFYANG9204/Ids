Dim cat, cat_1, cat_2

''''''''' 可以通过编辑 Txt_DelUseless.txt 简单得出 '''''''''
        #include "ClrQes.mrs"
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

Respondent_Serial=RESP_NUMBER

If BEAST_WEIGHT = True Then DPWT=weight1

Dim KeyBrandCode[]
KeyBrandCode[01] = "colddrink_1"
KeyBrandCode[02] = "colddrink_2"
KeyBrandCode[03] = "colddrink_3"
KeyBrandCode[04] = "colddrink_4"
KeyBrandCode[05] = "colddrink_5"
KeyBrandCode[06] = "colddrink_9"
KeyBrandCode[07] = "colddrink_10"
KeyBrandCode[08] = "colddrink_11"
KeyBrandCode[09] = "colddrink_16"
KeyBrandCode[10] = "colddrink_17"
KeyBrandCode[11] = "colddrink_28"
KeyBrandCode[12] = "colddrink_39"
KeyBrandCode[13] = "colddrink_51"


For Each cat in AwInt_01.Categories

if BR_AWARE[{QB1}].slice.containsany(CCategorical(cat.name))  then AwInt_01=AwInt_01+CCategorical(cat.name)
if oeQB2_temp[{_1}].slice.containsany(CCategorical(cat.name)) then AwInt_02=AwInt_02+CCategorical(cat.name)
if oeQB2_temp[{_2}].slice.containsany(CCategorical(cat.name)) then AwInt_03=AwInt_03+CCategorical(cat.name)
if oeQB2_temp[{_3}].slice.containsany(CCategorical(cat.name)) then AwInt_04=AwInt_04+CCategorical(cat.name)
if oeQB2_temp[{_4}].slice.containsany(CCategorical(cat.name)) then AwInt_05=AwInt_05+CCategorical(cat.name)
if oeQB2_temp[{_5}].slice.containsany(CCategorical(cat.name)) then AwInt_06=AwInt_06+CCategorical(cat.name)
if oeQB2_temp[{_6}].slice.containsany(CCategorical(cat.name)) then AwInt_07=AwInt_07+CCategorical(cat.name)
if oeQB2_temp[{_7}].slice.containsany(CCategorical(cat.name)) then AwInt_08=AwInt_08+CCategorical(cat.name)
if oeQB2_temp[{_8}].slice.containsany(CCategorical(cat.name)) then AwInt_09=AwInt_09+CCategorical(cat.name)
if oeQB2_temp[{_9}].slice.containsany(CCategorical(cat.name)) then AwInt_10=AwInt_10+CCategorical(cat.name)

Next

if CityTG.containsany({_4}) then SS_SubSample1=SS_SubSample1+{_1}
if CityTG.containsany({_5}) then SS_SubSample1=SS_SubSample1+{_2}
if CityTG.containsany({_6}) then SS_SubSample1=SS_SubSample1+{_3}
if CityTG.containsany({_7}) then SS_SubSample1=SS_SubSample1+{_4}

if CityTG.containsany({_1}) then SS_SubSample2=SS_SubSample2+{_1}
if CityTG.containsany({_2}) then SS_SubSample2=SS_SubSample2+{_2}
if CityTG.containsany({_3}) then SS_SubSample2=SS_SubSample2+{_3}


sbEmtBeastQesYN(dmgrjob,BR_AWARE[{QB1_QB2}],"TotalUnaided",Comp={Completed},KeyBrandCode)
sbEmtBeastQesYN(dmgrjob,BR_AWARE[{QB3}]    ,"Aided"       ,Comp={Completed},KeyBrandCode)
sbEmtBeastQesYN(dmgrjob,BR_AWARE[{QB8}]    ,"BoughtLast"  ,Comp={Completed},KeyBrandCode)

sbEmtBeastQesSC(dmgrjob,QB9,"Consideration"  ,KeyBrandCode)
sbEmtBeastQesSC(dmgrjob,BE6,"Affinity_scale" ,KeyBrandCode)
sbEmtBeastQesSC(dmgrjob,BP1,"Unique_scale"   ,KeyBrandCode)
sbEmtBeastQesSC(dmgrjob,BP2,"MeetNeeds_scale",KeyBrandCode)
sbEmtBeastQesSC(dmgrjob,BP3,"Dynamic_scale"  ,KeyBrandCode)
sbEmtBeastQesSC(dmgrjob,BP5,"Price_scale"    ,KeyBrandCode)
sbEmtBeastQesSC(dmgrjob,BP6,"Worth_scale"    ,KeyBrandCode)

if BD1.containsany({_1}) then CLUSTA=CLUSTA+{_1}
if BD1.containsany({_2}) then CLUSTA=CLUSTA+{_2}
if BD1.containsany({_3}) then CLUSTA=CLUSTA+{_3}

if BD2.containsany({_1}) then CLUSTB=CLUSTB+{_1}
if BD2.containsany({_2}) then CLUSTB=CLUSTB+{_2}


sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN10",BR_AWARE[{QB3}],"colddrink_1" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN1" ,BR_AWARE[{QB3}],"colddrink_2" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN2" ,BR_AWARE[{QB3}],"colddrink_3" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN3" ,BR_AWARE[{QB3}],"colddrink_4" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN4" ,BR_AWARE[{QB3}],"colddrink_5" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN5" ,BR_AWARE[{QB3}],"colddrink_6" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN6" ,BR_AWARE[{QB3}],"colddrink_7" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"DIFF1",BR_AWARE[{QB3}],"colddrink_8" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"EMO1" ,BR_AWARE[{QB3}],"colddrink_9" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"EMO2" ,BR_AWARE[{QB3}],"colddrink_10",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"EMO3" ,BR_AWARE[{QB3}],"colddrink_11",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"EMO4" ,BR_AWARE[{QB3}],"colddrink_12",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"EMO5" ,BR_AWARE[{QB3}],"colddrink_13",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN7" ,BR_AWARE[{QB3}],"colddrink_14",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"EMO6" ,BR_AWARE[{QB3}],"colddrink_15",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FAM2" ,BR_AWARE[{QB3}],"colddrink_17",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"ASS1" ,BR_AWARE[{QB3}],"colddrink_18",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN8" ,BR_AWARE[{QB3}],"colddrink_19",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FAM3" ,BR_AWARE[{QB3}],"colddrink_20",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FAM1" ,BR_AWARE[{QB3}],"colddrink_21",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BP9_rev,"FUN9" ,BR_AWARE[{QB3}],"colddrink_22",KeyBrandCode)

sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT1" ,BR_AWARE[{QB3}],"colddrink_1" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT2" ,BR_AWARE[{QB3}],"colddrink_2" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT3" ,BR_AWARE[{QB3}],"colddrink_3" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT4" ,BR_AWARE[{QB3}],"colddrink_4" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT5" ,BR_AWARE[{QB3}],"colddrink_5" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT6" ,BR_AWARE[{QB3}],"colddrink_6" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT7" ,BR_AWARE[{QB3}],"colddrink_7" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT8" ,BR_AWARE[{QB3}],"colddrink_8" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT9" ,BR_AWARE[{QB3}],"colddrink_9" ,KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT10",BR_AWARE[{QB3}],"colddrink_10",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT11",BR_AWARE[{QB3}],"colddrink_11",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT12",BR_AWARE[{QB3}],"colddrink_12",KeyBrandCode)
sbEmtBeastQesYN_image(dmgrjob,BF1,"ACT13",BR_AWARE[{QB3}],"colddrink_13",KeyBrandCode)


''''''''''''''''''''''''''''' Subroutine  ''''''''''''''''''''''''''''''''''''''''''''


sub sbEmtBeastQesSC(dmgrjob,SourceQ,TargetQ,code[])

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

      dim i, axisname, fstname, cat

''''		  if ubound(code) < 10 then fstname = "_1"
''''   		if ubound(code) >= 10 then fstname = "_01"
      fstname = "_01"
      
      For Each cat in dmgrjob.Questions[TargetQ + fstname].Categories
				For i = 1 to ubound(code)

				if i < 10 then axisname = "_0" + cText(i)
				if i >= 10 then axisname = "_" + cText(i)

        if SourceQ[code[i]].Slice.containsany(CCategorical(cat.name)) then dmgrjob.Questions[TargetQ + axisname].Response.Value=dmgrjob.Questions[TargetQ + axisname].Response.Value+CCategorical(cat.name)

        Next
      Next


end sub


sub sbEmtBeastQesYN(dmgrjob,SourceQ,TargetQ,base,code[])

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

      dim i, axisname

				For i = 1 to ubound(code)

				if i < 10 then axisname = "_0" + cText(i)
				if i >= 10 then axisname = "_" + cText(i)

        if base and SourceQ.Slice.containsany(CCategorical(code[i])) then dmgrjob.Questions[TargetQ + axisname].Response.Value=dmgrjob.Questions[TargetQ + axisname].Response.Value+{_1}
        if base and not(SourceQ.Slice.containsany(CCategorical(code[i]))) then dmgrjob.Questions[TargetQ + axisname].Response.Value=dmgrjob.Questions[TargetQ + axisname].Response.Value+{_2}

        Next


end sub

sub sbEmtBeastQesYN_image(dmgrjob,SourceQ,TargetQ,base,SourceCode,code[])

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

      dim i, axisname

				For i = 1 to ubound(code)

				if i < 10 then axisname = "_0" + cText(i)
				if i >= 10 then axisname = "_" + cText(i)

        if base.Slice.containsany(CCategorical(code[i])) and SourceQ[code[i]].Slice.containsany(CCategorical(SourceCode)) then dmgrjob.Questions[TargetQ + axisname].Response.Value=dmgrjob.Questions[TargetQ + axisname].Response.Value+{_1}
        if base.Slice.containsany(CCategorical(code[i])) and not(SourceQ[code[i]].Slice.containsany(CCategorical(SourceCode))) then dmgrjob.Questions[TargetQ + axisname].Response.Value=dmgrjob.Questions[TargetQ + axisname].Response.Value+{_2}

        Next


end sub

sub sbEmtBeastQesYN_old(dmgrjob,qes,base,condition)

qes=Null
if (base and condition)       then qes=qes+{_1}
if (base and not (condition)) then qes=qes+{_2}

end sub

